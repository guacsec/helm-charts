# Copyright Kusari, Inc. and GUAC contributors
# Licensed under the MIT license. See LICENSE file in the project root for details.
suite: Custom Labels on All Resources tests
templates:
  - graphql-server-deployment.yaml
  - graphql-server-service.yaml
  - graphql-server-sa.yaml
  - guacrest-deployment.yaml
  - guacrest-service.yaml
  - guacrest-sa.yaml
  - ingestor-deployment.yaml
  - ingestor-sa.yaml
  - collectsub-deployment.yaml
  - collectsub-service.yaml
  - collectsub-sa.yaml
  - oci-collector-deployment.yaml
  - oci-collector-sa.yaml
  - depsdev-collector-deployment.yaml
  - depsdev-collector-sa.yaml
  - osv-certifier-deployment.yaml
  - osv-certifier-sa.yaml
  - cd-certifier-deployment.yaml
  - cd-certifier-sa.yaml
  - visualizer-deployment.yaml
  - visualizer-service.yaml
  - scorecard-certifier-deployment.yaml
  - scorecard-certifier-sa.yaml
  - guac-cm.yaml
  - api-only-ingress.yaml
  - ingress.yaml
  - ingressroute.yaml

tests:
  - it: should include customLabels in graphql-server deployment
    template: graphql-server-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in guacrest deployment
    template: guacrest-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in ingestor deployment
    template: ingestor-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in collectsub deployment
    template: collectsub-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in oci-collector deployment
    template: oci-collector-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in depsdev-collector deployment
    template: depsdev-collector-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in osv-certifier deployment
    template: osv-certifier-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in cd-certifier deployment
    template: cd-certifier-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in visualizer deployment
    template: visualizer-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in graphql-server service
    template: graphql-server-service.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in guacrest service
    template: guacrest-service.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in collectsub service
    template: collectsub-service.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in visualizer service
    template: visualizer-service.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in graphql-server service account
    template: graphql-server-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in guacrest service account
    template: guacrest-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in ingestor service account
    template: ingestor-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in collectsub service account
    template: collectsub-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in oci-collector service account
    template: oci-collector-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in depsdev-collector service account
    template: depsdev-collector-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in osv-certifier service account
    template: osv-certifier-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in cd-certifier service account
    template: cd-certifier-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in scorecard-certifier deployment
    template: scorecard-certifier-deployment.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in scorecard-certifier service account
    template: scorecard-certifier-sa.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in guac configmap
    template: guac-cm.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in ingress
    template: ingress.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in api-only-ingress
    template: api-only-ingress.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2

  - it: should include customLabels in traefik ingressroute
    template: ingressroute.yaml
    values:
      - ./values_customlabels.yaml
    asserts:
      - equal:
          path: metadata.labels.customlabel-1
          value: value-1
      - equal:
          path: metadata.labels.customlabel-2
          value: value-2
